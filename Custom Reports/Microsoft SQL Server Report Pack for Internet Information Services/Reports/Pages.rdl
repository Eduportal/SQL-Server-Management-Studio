<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="IISDatabase">
      <DataSourceReference>IISDatabase</DataSourceReference>
      <rd:DataSourceID>d627e577-63f1-4a9f-b33d-d60330ff8133</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <BottomMargin>0.5cm</BottomMargin>
  <RightMargin>0.5cm</RightMargin>
  <PageWidth>21cm</PageWidth>
  <ReportParameters>
    <ReportParameter Name="month">
      <DataType>Integer</DataType>
      <DefaultValue>
        <Values>
          <Value>10</Value>
        </Values>
      </DefaultValue>
      <Prompt>Month</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>1</Value>
            <Label>Jan</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>2</Value>
            <Label>Feb</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>3</Value>
            <Label>Mar</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>4</Value>
            <Label>Apr</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>5</Value>
            <Label>May</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>6</Value>
            <Label>Jun</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>7</Value>
            <Label>Jui</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>8</Value>
            <Label>Aug</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>9</Value>
            <Label>Sep</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>10</Value>
            <Label>Oct</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>11</Value>
            <Label>Nov</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>12</Value>
            <Label>Dec</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="Year">
      <DataType>Integer</DataType>
      <DefaultValue>
        <Values>
          <Value>2004</Value>
        </Values>
      </DefaultValue>
      <Prompt>Year</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>2003</Value>
          </ParameterValue>
          <ParameterValue>
            <Value>2004</Value>
          </ParameterValue>
          <ParameterValue>
            <Value>2005</Value>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="ComputerName">
      <DataType>String</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <Values>
          <Value>ALL</Value>
        </Values>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>IIS Server Name</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>Servers</DataSetName>
          <ValueField>sComputername</ValueField>
          <LabelField>sComputername</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
  </ReportParameters>
  <rd:DrawGrid>true</rd:DrawGrid>
  <InteractiveWidth>8.5in</InteractiveWidth>
  <rd:GridSpacing>0.25cm</rd:GridSpacing>
  <rd:SnapToGrid>true</rd:SnapToGrid>
  <Body>
    <ColumnSpacing>1cm</ColumnSpacing>
    <ReportItems>
      <Chart Name="chart1">
        <Legend>
          <Visible>true</Visible>
          <Style>
            <BorderStyle>
              <Default>Solid</Default>
            </BorderStyle>
            <FontFamily>trebuchet ms</FontFamily>
          </Style>
          <Position>BottomCenter</Position>
          <Layout>Row</Layout>
        </Legend>
        <Subtype>Plain</Subtype>
        <Title />
        <Height>10.2381cm</Height>
        <CategoryAxis>
          <Axis>
            <Title />
            <Style>
              <FontSize>8pt</FontSize>
            </Style>
            <MajorGridLines>
              <Style>
                <BorderStyle>
                  <Default>Solid</Default>
                </BorderStyle>
              </Style>
            </MajorGridLines>
            <MinorGridLines>
              <Style>
                <BorderStyle>
                  <Default>Solid</Default>
                </BorderStyle>
              </Style>
            </MinorGridLines>
          </Axis>
        </CategoryAxis>
        <PointWidth>0</PointWidth>
        <Left>0.25cm</Left>
        <ThreeDProperties>
          <Enabled>true</Enabled>
          <ProjectionMode>Orthographic</ProjectionMode>
          <Inclination>15</Inclination>
          <Perspective>33</Perspective>
          <Shading>Real</Shading>
          <DrawingStyle>Cylinder</DrawingStyle>
        </ThreeDProperties>
        <DataSetName>Historical</DataSetName>
        <Filters>
          <Filter>
            <Operator>TopN</Operator>
            <FilterValues>
              <FilterValue>=5</FilterValue>
            </FilterValues>
            <FilterExpression>=Fields!nb.Value</FilterExpression>
          </Filter>
        </Filters>
        <SeriesGroupings>
          <SeriesGrouping>
            <StaticSeries>
              <StaticMember>
                <Label>Visits</Label>
              </StaticMember>
              <StaticMember>
                <Label>Band Width</Label>
              </StaticMember>
            </StaticSeries>
          </SeriesGrouping>
        </SeriesGroupings>
        <Top>4.75cm</Top>
        <PlotArea>
          <Style>
            <BorderStyle>
              <Default>Solid</Default>
            </BorderStyle>
            <BackgroundColor>LightGrey</BackgroundColor>
          </Style>
        </PlotArea>
        <ValueAxis>
          <Axis>
            <Title>
              <Caption>Visits</Caption>
              <Style>
                <FontFamily>trebuchet ms</FontFamily>
                <Color>Maroon</Color>
              </Style>
            </Title>
            <MajorGridLines>
              <ShowGridLines>true</ShowGridLines>
              <Style>
                <BorderStyle>
                  <Default>Solid</Default>
                </BorderStyle>
              </Style>
            </MajorGridLines>
            <MinorGridLines>
              <Style>
                <BorderStyle>
                  <Default>Solid</Default>
                </BorderStyle>
              </Style>
            </MinorGridLines>
            <Margin>true</Margin>
            <Visible>true</Visible>
            <Scalar>true</Scalar>
          </Axis>
        </ValueAxis>
        <ZIndex>3</ZIndex>
        <Type>Bar</Type>
        <Width>18.75cm</Width>
        <CategoryGroupings>
          <CategoryGrouping>
            <DynamicCategories>
              <Grouping Name="chart1_CategoryGroup1">
                <GroupExpressions>
                  <GroupExpression>=Fields!Page.Value</GroupExpression>
                </GroupExpressions>
              </Grouping>
              <Sorting>
                <SortBy>
                  <SortExpression>=Fields!nb.Value</SortExpression>
                  <Direction>Ascending</Direction>
                </SortBy>
              </Sorting>
              <Label>=Fields!Page.Value</Label>
            </DynamicCategories>
          </CategoryGrouping>
        </CategoryGroupings>
        <Palette>Pastel</Palette>
        <ChartData>
          <ChartSeries>
            <DataPoints>
              <DataPoint>
                <DataValues>
                  <DataValue>
                    <Value>=Sum(Fields!nb.Value)</Value>
                  </DataValue>
                </DataValues>
                <DataLabel />
                <Marker>
                  <Size>6pt</Size>
                </Marker>
              </DataPoint>
            </DataPoints>
          </ChartSeries>
          <ChartSeries>
            <DataPoints>
              <DataPoint>
                <DataValues>
                  <DataValue>
                    <Value>=Sum(Fields!BandWidth.Value)</Value>
                  </DataValue>
                </DataValues>
                <DataLabel />
                <Marker />
              </DataPoint>
            </DataPoints>
          </ChartSeries>
        </ChartData>
        <Style>
          <BackgroundColor>White</BackgroundColor>
        </Style>
      </Chart>
      <Textbox Name="textbox10">
        <ZIndex>2</ZIndex>
        <Width>19.25cm</Width>
        <Style>
          <BorderStyle>
            <Bottom>Solid</Bottom>
            <Top>Solid</Top>
          </BorderStyle>
          <TextAlign>Center</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <BorderWidth>
            <Default>2pt</Default>
          </BorderWidth>
          <PaddingBottom>2pt</PaddingBottom>
          <FontFamily>trebuchet ms</FontFamily>
          <FontWeight>700</FontWeight>
          <FontSize>14pt</FontSize>
          <BorderColor>
            <Default>Maroon</Default>
          </BorderColor>
          <Color>Maroon</Color>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
        </Style>
        <CanGrow>true</CanGrow>
        <Height>1.00529cm</Height>
        <Value>="Results for " &amp; Parameters!month.Label &amp; " " &amp; Parameters!Year.Value &amp; " - Server : " &amp; Parameters!ComputerName.Value</Value>
      </Textbox>
      <Textbox Name="textbox4">
        <Top>1.5cm</Top>
        <rd:DefaultName>textbox4</rd:DefaultName>
        <ZIndex>1</ZIndex>
        <Width>19.25cm</Width>
        <Style>
          <BorderStyle>
            <Bottom>Solid</Bottom>
            <Top>Solid</Top>
          </BorderStyle>
          <TextAlign>Center</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <BorderWidth>
            <Default>2pt</Default>
          </BorderWidth>
          <PaddingBottom>2pt</PaddingBottom>
          <FontFamily>trebuchet ms</FontFamily>
          <FontWeight>700</FontWeight>
          <FontSize>14pt</FontSize>
          <BorderColor>
            <Default>Maroon</Default>
          </BorderColor>
          <Color>Maroon</Color>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
        </Style>
        <CanGrow>true</CanGrow>
        <Height>1.00529cm</Height>
        <Value>Top 5 Pages</Value>
      </Textbox>
      <Table Name="table1">
        <Left>0.25cm</Left>
        <Filters>
          <Filter>
            <Operator>TopN</Operator>
            <FilterValues>
              <FilterValue>=5</FilterValue>
            </FilterValues>
            <FilterExpression>=Fields!nb.Value</FilterExpression>
          </Filter>
        </Filters>
        <DataSetName>Historical</DataSetName>
        <Top>2.75cm</Top>
        <TableGroups>
          <TableGroup>
            <Sorting>
              <SortBy>
                <SortExpression>=Fields!nb.Value</SortExpression>
                <Direction>Descending</Direction>
              </SortBy>
            </Sorting>
            <Grouping Name="Grp_CountryGroup">
              <GroupExpressions>
                <GroupExpression>=Fields!Page.Value</GroupExpression>
              </GroupExpressions>
            </Grouping>
          </TableGroup>
        </TableGroups>
        <Width>18.71885cm</Width>
        <Details>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Page">
                      <rd:DefaultName>Page</rd:DefaultName>
                      <ZIndex>3</ZIndex>
                      <Action>
                        <Hyperlink>=Fields!Page.Value</Hyperlink>
                      </Action>
                      <Style>
                        <BorderStyle>
                          <Bottom>Solid</Bottom>
                        </BorderStyle>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingBottom>2pt</PaddingBottom>
                        <FontFamily>Trebuchet ms</FontFamily>
                        <FontSize>9pt</FontSize>
                        <BorderColor>
                          <Default>DarkViolet</Default>
                        </BorderColor>
                        <BackgroundColor>=IIf((runningvalue( Fields!Page.Value ,countdistinct,nothing) Mod 2), "White", "CornSilk")</BackgroundColor>
                        <Color>DarkViolet</Color>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!Page.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="nb">
                      <rd:DefaultName>nb</rd:DefaultName>
                      <ZIndex>2</ZIndex>
                      <Style>
                        <BorderStyle>
                          <Bottom>Solid</Bottom>
                        </BorderStyle>
                        <TextAlign>Right</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingBottom>2pt</PaddingBottom>
                        <FontFamily>Trebuchet ms</FontFamily>
                        <FontWeight>700</FontWeight>
                        <FontSize>9pt</FontSize>
                        <BorderColor>
                          <Default>DarkViolet</Default>
                        </BorderColor>
                        <BackgroundColor>=IIf((runningvalue( Fields!Page.Value ,countdistinct,nothing) Mod 2), "White", "CornSilk")</BackgroundColor>
                        <Color>DarkViolet</Color>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!nb.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="BandWidth">
                      <rd:DefaultName>BandWidth</rd:DefaultName>
                      <ZIndex>1</ZIndex>
                      <Style>
                        <BorderStyle>
                          <Bottom>Solid</Bottom>
                        </BorderStyle>
                        <TextAlign>Right</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingBottom>2pt</PaddingBottom>
                        <FontFamily>Trebuchet ms</FontFamily>
                        <FontWeight>700</FontWeight>
                        <FontSize>9pt</FontSize>
                        <BorderColor>
                          <Default>DarkViolet</Default>
                        </BorderColor>
                        <BackgroundColor>=IIf((runningvalue( Fields!Page.Value ,countdistinct,nothing) Mod 2), "White", "CornSilk")</BackgroundColor>
                        <Color>DarkViolet</Color>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!BandWidth.Value</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox9">
                      <rd:DefaultName>textbox9</rd:DefaultName>
                      <Style>
                        <BorderStyle>
                          <Bottom>Solid</Bottom>
                        </BorderStyle>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingBottom>2pt</PaddingBottom>
                        <FontFamily>Trebuchet ms</FontFamily>
                        <FontWeight>700</FontWeight>
                        <FontSize>9pt</FontSize>
                        <Format>P</Format>
                        <BorderColor>
                          <Default>DarkViolet</Default>
                        </BorderColor>
                        <BackgroundColor>=IIf((runningvalue( Fields!Page.Value ,countdistinct,nothing) Mod 2), "White", "CornSilk")</BackgroundColor>
                        <Color>DarkViolet</Color>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>=Fields!nb.Value /count(Fields!nb.Value,"Historical")</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.63492cm</Height>
            </TableRow>
          </TableRows>
        </Details>
        <Header>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox1">
                      <rd:DefaultName>textbox1</rd:DefaultName>
                      <ZIndex>7</ZIndex>
                      <Style>
                        <BorderStyle>
                          <Bottom>Solid</Bottom>
                        </BorderStyle>
                        <TextAlign>Center</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingBottom>2pt</PaddingBottom>
                        <FontFamily>Trebuchet MS</FontFamily>
                        <FontWeight>700</FontWeight>
                        <FontSize>11pt</FontSize>
                        <BorderColor>
                          <Default>MediumPurple</Default>
                        </BorderColor>
                        <BackgroundColor>White</BackgroundColor>
                        <Color>SteelBlue</Color>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>Page</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox3">
                      <rd:DefaultName>textbox3</rd:DefaultName>
                      <ZIndex>6</ZIndex>
                      <Style>
                        <BorderStyle>
                          <Bottom>Solid</Bottom>
                        </BorderStyle>
                        <TextAlign>Right</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingBottom>2pt</PaddingBottom>
                        <FontFamily>Trebuchet MS</FontFamily>
                        <FontWeight>700</FontWeight>
                        <FontSize>11pt</FontSize>
                        <BorderColor>
                          <Default>MediumPurple</Default>
                        </BorderColor>
                        <Color>SteelBlue</Color>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>Visits</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox7">
                      <ZIndex>5</ZIndex>
                      <Style>
                        <BorderStyle>
                          <Bottom>Solid</Bottom>
                        </BorderStyle>
                        <TextAlign>Right</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingBottom>2pt</PaddingBottom>
                        <FontFamily>Trebuchet MS</FontFamily>
                        <FontWeight>700</FontWeight>
                        <FontSize>11pt</FontSize>
                        <BorderColor>
                          <Default>MediumPurple</Default>
                        </BorderColor>
                        <Color>SteelBlue</Color>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>Bandwidth</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox6">
                      <rd:DefaultName>textbox6</rd:DefaultName>
                      <ZIndex>4</ZIndex>
                      <Style>
                        <BorderStyle>
                          <Bottom>Solid</Bottom>
                        </BorderStyle>
                        <TextAlign>Center</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingBottom>2pt</PaddingBottom>
                        <FontFamily>Trebuchet MS</FontFamily>
                        <FontWeight>700</FontWeight>
                        <FontSize>11pt</FontSize>
                        <BorderColor>
                          <Default>MediumPurple</Default>
                        </BorderColor>
                        <Color>SteelBlue</Color>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Value>%</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>1cm</Height>
            </TableRow>
          </TableRows>
        </Header>
        <TableColumns>
          <TableColumn>
            <Width>12.96395cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>1.5cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2.25cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2.0049cm</Width>
          </TableColumn>
        </TableColumns>
        <Height>1.63492cm</Height>
      </Table>
    </ReportItems>
    <Height>15.25cm</Height>
  </Body>
  <rd:ReportID>3ff8d4ad-32ab-4f7d-8a17-764107ba8555</rd:ReportID>
  <LeftMargin>0.5cm</LeftMargin>
  <DataSets>
    <DataSet Name="Historical">
      <Query>
        <CommandType>StoredProcedure</CommandType>
        <CommandText>SummaryByPopularPages</CommandText>
        <QueryParameters>
          <QueryParameter Name="@Month">
            <Value>=Parameters!month.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Year">
            <Value>=Parameters!Year.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@ComputerName">
            <Value>=Parameters!ComputerName.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <DataSourceName>IISDatabase</DataSourceName>
      </Query>
      <Fields>
        <Field Name="nb">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>Nb</DataField>
        </Field>
        <Field Name="Page">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>Page</DataField>
        </Field>
        <Field Name="BandWidth">
          <rd:TypeName>System.Int32</rd:TypeName>
          <DataField>BandWidth</DataField>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="Servers">
      <Query>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
        <CommandText>SELECT DISTINCT sComputername
FROM         GlobalIISLog
UNION
SELECT     'ALL' AS sComputername</CommandText>
        <DataSourceName>IISDatabase</DataSourceName>
      </Query>
      <Fields>
        <Field Name="sComputername">
          <rd:TypeName>System.String</rd:TypeName>
          <DataField>sComputername</DataField>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <Code />
  <Width>7.62135in</Width>
  <InteractiveHeight>11in</InteractiveHeight>
  <Description>Shows a table and chart that shows the top 5 pages per site based on the number of visits and bandwidth. </Description>
  <TopMargin>0.5cm</TopMargin>
  <PageHeight>29.7cm</PageHeight>
</Report>